<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>News & Insights | ASPL Fusion</title>
    <meta name="description" content="Latest news, updates, and insights from ASPL Fusion - India's pioneering fusion energy company.">
    
    <!-- SEO Meta Tags -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://dugy-jha.github.io/news.html">
    <meta property="og:title" content="News & Insights | ASPL Fusion">
    <meta property="og:description" content="Latest news, updates, and insights from ASPL Fusion - India's pioneering fusion energy company.">
    <meta property="og:image" content="hero-background.jpg">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="icon" href="Logo-t-removebg-preview.png" type="image/png">
    <link rel="stylesheet" href="style.css">
    <!-- Add Marked.js for Markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="container">
                <a href="index.html" class="logo">
                    <img src="Logo-t-removebg-preview.png" alt="ASPL Fusion Logo" class="logo-img">
                    <span>ASPL<span class="highlight">Fusion</span></span>
                </a>
                <button id="mobile-menu-button" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="mobile-menu">
                    <i class="fas fa-bars"></i>
                </button>
                <ul class="nav-links" id="mobile-menu" role="menu" aria-label="Main navigation">
                    <li><a href="mission.html" role="menuitem">Our Mission</a></li>
                    <li><a href="technology.html" role="menuitem">Technology</a></li>
                    <li><a href="roadmap.html" role="menuitem">Roadmap</a></li>
                    <li><a href="applications.html" role="menuitem">Applications</a></li>
                    <li><a href="casestudies.html" role="menuitem">Case Studies</a></li>
                    <li><a href="about.html" role="menuitem">About Us</a></li>
                    <li><a href="news.html" class="active" role="menuitem">News</a></li>
                    <li><a href="careers.html" role="menuitem">Careers</a></li>
                    <li><a href="contact.html" class="cta-button" role="menuitem">Contact</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main>
        <section class="page-header">
            <div class="container">
                <h1>News & Insights</h1>
                <p class="subtitle">Stay updated on the latest developments from ASPL Fusion</p>
            </div>
        </section>
        
        <section class="content-section">
            <div class="container">
                <div class="news-container">
                    <div class="news-filters">
                        <h3>Categories</h3>
                        <ul id="category-filters">
                            <li><a href="#" data-category="all" class="active">All Updates</a></li>
                            <li><a href="#" data-category="Company News">Company News</a></li>
                            <li><a href="#" data-category="Technology Updates">Technology Updates</a></li>
                            <li><a href="#" data-category="Industry Insights">Industry Insights</a></li>
                            <li><a href="#" data-category="Events">Events</a></li>
                            <li><a href="#" data-category="Press Releases">Press Releases</a></li>
                        </ul>
                    </div>
                    
                    <div class="news-content">
                        <div id="news-grid" class="news-grid">
                            <!-- News articles will be dynamically loaded here -->
                            <div class="loading-indicator">
                                <i class="fas fa-spinner"></i>
                                <p>Loading articles...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <a href="index.html" class="logo">
                        <img src="Logo-t-removebg-preview.png" alt="ASPL Fusion Logo" class="logo-img">
                        <span>ASPL<span class="highlight">Fusion</span></span>
                    </a>
                    <p>Agnira Sanlayan Pvt. Ltd.</p>
                    <p>Powering India's future through fusion innovation.</p>
                </div>
                <div class="footer-links">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="mission.html">Our Mission</a></li>
                        <li><a href="technology.html">Technology</a></li>
                        <li><a href="roadmap.html">Roadmap</a></li>
                        <li><a href="applications.html">Applications</a></li>
                        <li><a href="casestudies.html">Case Studies</a></li>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="news.html">News</a></li>
                        <li><a href="careers.html">Careers</a></li>
                        <li><a href="faq.html">FAQ</a></li>
                    </ul>
                </div>
                <div class="footer-contact">
                    <h4>Contact</h4>
                    <p><i class="fas fa-envelope"></i> <a href="mailto:info@asplfusion.com">info@asplfusion.com</a></p>
                    <p><i class="fas fa-phone"></i> <a href="tel:+9101141519899">+91 (011)-4151-9899</a></p>
                    <p><i class="fas fa-map-marker-alt"></i> 101 Mercantile House, 15 Kastoorba Gandhi Marg, New Delhi - 110001, India</p>
                </div>
                <div class="footer-social">
                    <h4>Connect</h4>
                    <div class="social-icons">
                        <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Agnira Sanlayan Pvt. Ltd. (ASPL Fusion). All Rights Reserved.</p>
                <div class="legal-links">
                    <a href="privacy.html">Privacy Policy</a>
                    <a href="terms.html">Terms of Service</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Dark Mode Toggle Button -->
    <button id="dark-mode-toggle" class="dark-mode-toggle" aria-label="Toggle dark mode">
        <i class="fas fa-moon"></i>
        <i class="fas fa-sun"></i>
    </button>

    <!-- Article Template (hidden) -->
    <template id="article-template">
        <article class="news-item">
            <a href="#" class="news-link">
                <div class="news-image">
                    <img src="" alt="">
                    <span class="news-category"></span>
                </div>
                <div class="news-content">
                    <h3 class="news-title"></h3>
                    <p class="news-meta">
                        <span class="news-date"></span> | <span class="news-author"></span>
                    </p>
                    <p class="news-summary"></p>
                    <span class="news-read-more">Read More <i class="fas fa-arrow-right"></i></span>
                </div>
            </a>
        </article>
    </template>
    
    <!-- Article Page Template (for dynamic loading) -->
    <template id="article-page-template">
        <div class="article-container">
            <div class="article-header">
                <a href="news.html" class="back-to-news"><i class="fas fa-arrow-left"></i> Back to News</a>
                <span class="article-category"></span>
                <h1 class="article-title"></h1>
                <div class="article-meta">
                    <span class="article-date"></span> | <span class="article-author"></span>
                </div>
            </div>
            <div class="article-featured-image">
                <img src="" alt="">
            </div>
            <div class="article-body"></div>
        </div>
    </template>

    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const newsGrid = document.getElementById('news-grid');
            const articleTemplate = document.getElementById('article-template');
            const articlePageTemplate = document.getElementById('article-page-template');
            const categoryFilters = document.querySelectorAll('#category-filters a');
            let articles = [];
            
            // Function to format dates
            function formatDate(dateString) {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-IN', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
            }
            
            // Function to parse front matter from markdown files
            function parseFrontMatter(content) {
                const frontMatterRegex = /---\r?\n([\s\S]*?)\r?\n---/;
                const match = content.match(frontMatterRegex);
                
                if (!match) return { content };
                
                const frontMatter = {};
                const frontMatterText = match[1];
                
                const lines = frontMatterText.split('\n');
                for (const line of lines) {
                    const colonIndex = line.indexOf(':');
                    if (colonIndex !== -1) {
                        const key = line.slice(0, colonIndex).trim();
                        let value = line.slice(colonIndex + 1).trim();
                        
                        // Remove quotes if present
                        if (value.startsWith('"') && value.endsWith('"')) {
                            value = value.slice(1, -1);
                        }
                        
                        frontMatter[key] = value;
                    }
                }
                
                // Extract content after front matter
                const contentWithoutFrontMatter = content.replace(match[0], '').trim();
                
                return {
                    ...frontMatter,
                    content: contentWithoutFrontMatter
                };
            }
            
            // Function to load all articles from the _posts directory
            async function loadArticles() {
                try {
                    const response = await fetch('https://api.github.com/repos/dugy-jha/dugy-jha.github.io/contents/_posts');
                    if (!response.ok) throw new Error('Failed to fetch articles directory');
                    
                    const files = await response.json();
                    const markdownFiles = files.filter(file => file.name.endsWith('.md'));
                    
                    const articlePromises = markdownFiles.map(async file => {
                        const fileResponse = await fetch(file.download_url);
                        if (!fileResponse.ok) throw new Error(`Failed to fetch ${file.name}`);
                        
                        const content = await fileResponse.text();
                        const parsedArticle = parseFrontMatter(content);
                        
                        return {
                            slug: file.name.replace('.md', ''),
                            title: parsedArticle.title,
                            date: parsedArticle.date,
                            author: parsedArticle.author,
                            image: parsedArticle.image || 'assets/images/placeholder-person.svg',
                            summary: parsedArticle.summary,
                            category: parsedArticle.category,
                            content: parsedArticle.content
                        };
                    });
                    
                    articles = await Promise.all(articlePromises);
                    
                    // Sort articles by date (newest first)
                    articles.sort((a, b) => new Date(b.date) - new Date(a.date));
                    
                    displayArticles(articles);
                } catch (error) {
                    console.error('Error loading articles:', error);
                    newsGrid.innerHTML = `
                        <div class="error-message">
                            <i class="fas fa-exclamation-triangle"></i>
                            <p>Sorry, we couldn't load the latest articles. Please try again later.</p>
                        </div>
                    `;
                }
            }
            
            // Function to display articles
            function displayArticles(articlesToShow) {
                newsGrid.innerHTML = '';
                
                if (articlesToShow.length === 0) {
                    newsGrid.innerHTML = `
                        <div class="no-results">
                            <i class="fas fa-search"></i>
                            <p>No articles found in this category. Please check back later.</p>
                        </div>
                    `;
                    return;
                }
                
                articlesToShow.forEach(article => {
                    const template = document.importNode(articleTemplate.content, true);
                    
                    const link = template.querySelector('.news-link');
                    link.href = `news.html?article=${article.slug}`;
                    
                    const image = template.querySelector('.news-image img');
                    image.src = article.image;
                    image.alt = article.title;
                    
                    const category = template.querySelector('.news-category');
                    category.textContent = article.category;
                    
                    const title = template.querySelector('.news-title');
                    title.textContent = article.title;
                    
                    const date = template.querySelector('.news-date');
                    date.textContent = formatDate(article.date);
                    
                    const author = template.querySelector('.news-author');
                    author.textContent = article.author;
                    
                    const summary = template.querySelector('.news-summary');
                    summary.textContent = article.summary;
                    
                    newsGrid.appendChild(template);
                });
            }
            
            // Function to display a single article
            function displayArticlePage(article) {
                newsGrid.innerHTML = '';
                
                const template = document.importNode(articlePageTemplate.content, true);
                
                const category = template.querySelector('.article-category');
                category.textContent = article.category;
                
                const title = template.querySelector('.article-title');
                title.textContent = article.title;
                
                const date = template.querySelector('.article-date');
                date.textContent = formatDate(article.date);
                
                const author = template.querySelector('.article-author');
                author.textContent = article.author;
                
                const image = template.querySelector('.article-featured-image img');
                image.src = article.image;
                image.alt = article.title;
                
                const body = template.querySelector('.article-body');
                body.innerHTML = marked.parse(article.content);
                
                newsGrid.appendChild(template);
                
                // Update page title
                document.title = `${article.title} | ASPL Fusion`;
                
                // Update URL without reloading page
                window.history.pushState({}, '', `news.html?article=${article.slug}`);
            }
            
            // Check if there's an article parameter in the URL
            function checkForArticleParameter() {
                const urlParams = new URLSearchParams(window.location.search);
                const articleSlug = urlParams.get('article');
                
                if (articleSlug) {
                    // Find the article by slug
                    const article = articles.find(a => a.slug === articleSlug);
                    
                    if (article) {
                        // Display the article page
                        displayArticlePage(article);
                        
                        // Hide category filters
                        document.querySelector('.news-filters').style.display = 'none';
                    } else {
                        // Article not found, display an error
                        newsGrid.innerHTML = `
                            <div class="error-message">
                                <i class="fas fa-exclamation-triangle"></i>
                                <p>Sorry, we couldn't find the article you're looking for.</p>
                                <a href="news.html" class="btn btn-primary">Back to News</a>
                            </div>
                        `;
                    }
                }
            }
            
            // Handle category filter clicks
            categoryFilters.forEach(filter => {
                filter.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remove active class from all filters
                    categoryFilters.forEach(f => f.classList.remove('active'));
                    
                    // Add active class to clicked filter
                    this.classList.add('active');
                    
                    const category = this.getAttribute('data-category');
                    
                    if (category === 'all') {
                        displayArticles(articles);
                    } else {
                        const filteredArticles = articles.filter(article => article.category === category);
                        displayArticles(filteredArticles);
                    }
                });
            });
            
            // Listen for popstate events (browser back/forward)
            window.addEventListener('popstate', () => {
                if (window.location.search === '') {
                    // We're back to the main news page
                    document.querySelector('.news-filters').style.display = 'block';
                    displayArticles(articles);
                    document.title = 'News & Insights | ASPL Fusion';
                } else {
                    // Check if there's an article to display
                    checkForArticleParameter();
                }
            });
            
            // Start by loading all articles
            loadArticles().then(() => {
                // After articles are loaded, check if we should display a specific article
                checkForArticleParameter();
            });
        });
    </script>
</body>
</html>